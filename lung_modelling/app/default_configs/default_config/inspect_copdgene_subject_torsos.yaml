# Workflow to refine subject selection by inspecting torso meshes for holes
# Selected dirs can be regenerated by copying from formatted output of select_copdgene_subjects.yaml
dataset_root: null
log_level: "INFO"
use_multiprocessing: False

tasks:
  initialize:
    dataset_config_filename: "dataset_config.json"
    use_directory_index: True
    skip_dirs: []
    select_dirs: ['*15814W*INSP_B31f*', '*15814W*INSP_STD*',
                  '*16032X*INSP_B31f*', '*16032X*INSP_STD*',
                  '*16126G*INSP_B31f*', '*16126G*INSP_STD*',
                  '*16281S*INSP_B31f*', '*16281S*INSP_STD*',
                  '*16303C*INSP_B31f*', '*16303C*INSP_STD*',
                  '*16311B*INSP_B31f*', '*16311B*INSP_STD*',
                  '*16315J*INSP_B31f*', '*16315J*INSP_STD*',
                  '*16409S*INSP_B31f*', '*16409S*INSP_STD*',
                  '*16496N*INSP_B31f*', '*16496N*INSP_STD*',
                  '*16499T*INSP_B31f*', '*16499T*INSP_STD*',
                  '*16531P*INSP_B31f*', '*16531P*INSP_STD*',
                  '*16565G*INSP_B31f*', '*16565G*INSP_STD*',
                  '*16617Z*INSP_B31f*', '*16617Z*INSP_STD*',
                  '*17094Y*INSP_B31f*', '*17094Y*INSP_STD*',
                  '*17135M*INSP_B31f*', '*17135M*INSP_STD*',
                  '*17242N*INSP_B31f*', '*17242N*INSP_STD*',
                  '*17257A*INSP_B31f*', '*17257A*INSP_STD*',
                  '*17258C*INSP_B31f*', '*17258C*INSP_STD*',
                  '*17275C*INSP_B31f*', '*17275C*INSP_STD*',
                  '*17871S*INSP_B31f*', '*17871S*INSP_STD*',
                  '*17880T*INSP_B31f*', '*17880T*INSP_STD*',
                  '*17888J*INSP_B31f*', '*17888J*INSP_STD*',
                  '*17929X*INSP_B31f*', '*17929X*INSP_STD*',
                  '*17946X*INSP_B31f*', '*17946X*INSP_STD*',
                  '*18216R*INSP_B31f*', '*18216R*INSP_STD*',
                  '*18347G*INSP_B31f*', '*18347G*INSP_STD*',
                  '*18398X*INSP_B31f*', '*18398X*INSP_STD*',
                  '*18406W*INSP_B31f*', '*18406W*INSP_STD*',
                  '*18426C*INSP_B31f*', '*18426C*INSP_STD*',
                  '*18476R*INSP_B31f*', '*18476R*INSP_STD*',
                  '*18501Q*INSP_B31f*', '*18501Q*INSP_STD*',
                  '*18535H*INSP_B31f*', '*18535H*INSP_STD*',
                  '*18586Y*INSP_B31f*', '*18586Y*INSP_STD*',
                  '*18612Z*INSP_B31f*', '*18612Z*INSP_STD*',
                  '*18615F*INSP_B31f*', '*18615F*INSP_STD*',
                  '*18641G*INSP_B31f*', '*18641G*INSP_STD*',
                  '*18663Q*INSP_B31f*', '*18663Q*INSP_STD*',
                  '*18666W*INSP_B31f*', '*18666W*INSP_STD*',
                  '*18680Q*INSP_B31f*', '*18680Q*INSP_STD*',
                  '*18734N*INSP_B31f*', '*18734N*INSP_STD*',
                  '*18737T*INSP_B31f*', '*18737T*INSP_STD*',
                  '*18744Q*INSP_B31f*', '*18744Q*INSP_STD*',
                  '*18747W*INSP_B31f*', '*18747W*INSP_STD*',
                  '*18749A*INSP_B31f*', '*18749A*INSP_STD*',
                  '*18757Z*INSP_B31f*', '*18757Z*INSP_STD*',
                  '*18762S*INSP_B31f*', '*18762S*INSP_STD*',
                  '*18763U*INSP_B31f*', '*18763U*INSP_STD*',
                  '*18765Y*INSP_B31f*', '*18765Y*INSP_STD*',
                  '*18775B*INSP_B31f*', '*18775B*INSP_STD*',
                  '*18782Y*INSP_B31f*', '*18782Y*INSP_STD*',
                  '*18800A*INSP_B31f*', '*18800A*INSP_STD*',
                  '*18802E*INSP_B31f*', '*18802E*INSP_STD*',
                  '*18810D*INSP_B31f*', '*18810D*INSP_STD*',
                  '*18822K*INSP_B31f*', '*18822K*INSP_STD*',
                  '*18825Q*INSP_B31f*', '*18825Q*INSP_STD*',
                  '*18826S*INSP_B31f*', '*18826S*INSP_STD*',
                  '*18829Y*INSP_B31f*', '*18829Y*INSP_STD*',
                  '*18849E*INSP_B31f*', '*18849E*INSP_STD*',
                  '*18856B*INSP_B31f*', '*18856B*INSP_STD*',
                  '*18874D*INSP_B31f*', '*18874D*INSP_STD*',
                  '*18877J*INSP_B31f*', '*18877J*INSP_STD*',
                  '*18881A*INSP_B31f*', '*18881A*INSP_STD*',
                  '*18890B*INSP_B31f*', '*18890B*INSP_STD*',
                  '*18918X*INSP_B31f*', '*18918X*INSP_STD*',
                  '*18954B*INSP_B31f*', '*18954B*INSP_STD*',
                  '*18959L*INSP_B31f*', '*18959L*INSP_STD*',
                  '*18964E*INSP_B31f*', '*18964E*INSP_STD*',
                  '*18965G*INSP_B31f*', '*18965G*INSP_STD*',
                  '*18972D*INSP_B31f*', '*18972D*INSP_STD*',
                  '*18977N*INSP_B31f*', '*18977N*INSP_STD*',
                  '*18978P*INSP_B31f*', '*18978P*INSP_STD*',
                  '*19003F*INSP_B31f*', '*19003F*INSP_STD*',
                  '*19020F*INSP_B31f*', '*19020F*INSP_STD*',
                  '*19035S*INSP_B31f*', '*19035S*INSP_STD*',
                  '*19036U*INSP_B31f*', '*19036U*INSP_STD*',
                  '*19043R*INSP_B31f*', '*19043R*INSP_STD*',
                  '*19066D*INSP_B31f*', '*19066D*INSP_STD*',
                  '*19084F*INSP_B31f*', '*19084F*INSP_STD*',
                  '*19157G*INSP_B31f*', '*19157G*INSP_STD*',
                  '*19161X*INSP_B31f*', '*19161X*INSP_STD*',
                  '*19174G*INSP_B31f*', '*19174G*INSP_STD*',
                  '*19183H*INSP_B31f*', '*19183H*INSP_STD*',
                  '*19229F*INSP_B31f*', '*19229F*INSP_STD*',
                  '*19266L*INSP_B31f*', '*19266L*INSP_STD*',
                  '*19288V*INSP_B31f*', '*19288V*INSP_STD*',
                  '*19373M*INSP_B31f*', '*19373M*INSP_STD*',
                  '*19444J*INSP_B31f*', '*19444J*INSP_STD*',
                  '*19512A*INSP_B31f*', '*19512A*INSP_STD*',
                  '*19564T*INSP_B31f*', '*19564T*INSP_STD*',
                  '*19626P*INSP_B31f*', '*19626P*INSP_STD*',
                  '*19647X*INSP_B31f*', '*19647X*INSP_STD*',
                  '*19685F*INSP_B31f*', '*19685F*INSP_STD*',
                  '*19944D*INSP_B31f*', '*19944D*INSP_STD*',
                  '*19985R*INSP_B31f*', '*19985R*INSP_STD*',
                  '*19990K*INSP_B31f*', '*19990K*INSP_STD*',
                  '*20055L*INSP_B31f*', '*20055L*INSP_STD*',
                  '*20168Y*INSP_B31f*', '*20168Y*INSP_STD*',
                  '*20222E*INSP_B31f*', '*20222E*INSP_STD*',
                  '*20303E*INSP_B31f*', '*20303E*INSP_STD*',
                  '*20387K*INSP_B31f*', '*20387K*INSP_STD*',
                  '*20388M*INSP_B31f*', '*20388M*INSP_STD*',
                  '*20559N*INSP_B31f*', '*20559N*INSP_STD*',
                  '*21084X*INSP_B31f*', '*21084X*INSP_STD*',
                  '*21139W*INSP_B31f*', '*21139W*INSP_STD*',
                  '*21234Q*INSP_B31f*', '*21234Q*INSP_STD*',
                  '*21879K*INSP_B31f*', '*21879K*INSP_STD*',
                  '*22778J*INSP_B31f*', '*22778J*INSP_STD*',
                  ]

  extract_torso:
    task: "ExtractTorso"
    source_directory: "dicom"
    results_directory: "extract_torso"
    output_filename: "torso"
    params: { threshold: -320 }

  create_meshes_sw:
    task: "CreateMeshesSW"
    source_directory: "extract_torso"
    results_directory: "create_meshes_torso_for_inspection"
    image_glob: "*.nii"
    params: {
      pad: False,
      step_size: 3,
      decimate: False,
      remesh: False,
      smooth: False,
      fill_holes: False,
      remove_shared_faces: False,
      isolate_mesh: False }

  inspect_meshes:
    task: InspectMeshes
    source_directory: "create_meshes_torso_for_inspection"
    results_directory: "mesh_inspection"
    params: {}

  logging:


run_tasks: ["extract_torso", "create_meshes_sw", "inspect_meshes" ]